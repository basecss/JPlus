

Javascript  编码规范



1. 我们从不改变您的任何编码习惯。但我们不希望因为您错误的习惯导致代码效率下降和出错率上升。


2. 我们相信格式化工具可以有效规范代码格式，而不需要您手动去遵守这些格式。


3. 格式


3.1 缩进: 您可以使用 2 个空格、 4 个空格 、 1 个 Tab 或 其它您认为最合适的符号 创建缩进。

3.2 行宽: 原则上，不要让一行代码超过80个字符。当一条语句不能在单独一行写完时，可能有必要拆分它。在操作符后进行拆分，最好是在逗号后面拆分。当然您可以在有些情况忽略本规则。

3.3.注释: 接口性质的注释使用 /** */ 注释。 大范围代码介绍使用 /* */ 注释。 小量代码使用 // 注释。 您可以将 // 注释放在语句的末尾，也可以放在顶部。比如:


// 变量1
var a = 2;


或 

var a = 2;  // 变量1


3.4 格式化: { 和 [ 的位置不强制要求。不过最好使用下面 3 种格式之一:


function(){

}


function()
{

}


function()
    {



    }




3.5 空格: 为了界面清晰，建议在后缀的单目操作符后端空格，在双目运行符两端空格。比如:

function a(c, d) {   // , 和 )  后面空格

}


function () {    // 匿名函数的 ( 前需要空格

}

var a = {

 c: [2]

}

b = (e * a) + b


v = ++c - --a


您可以根据习惯决定是否需要在 () 和 [] 中增加空格。比如:

f( val );

n[ j ];

3.6 括号: 没有对括号额外要求，但在表达明确的时候不需要使用括号，比如下面的例子都是不对的:

typeof value
(a * f) - 4
(c + 1) + 6



4. 命名


命名规则有 3 种， 一种是 fileName 形式 叫 骆驼规则。
一种是 FileName 形式 叫 PASCAL 规则.
一种是 骆驼规则前加一个 _ 或 p_ 或 m_ 叫私有的骆驼规则。

4.1 局部变量和参数 使用 骆驼规则。
4.2 类的私有成员使用 私有的骆驼规则。
4.3 函数名使用 骆驼规则。
4.4 类、对象名和名字空间使用 PASCAL 规则。 (一般把需要 new 才能使用的函数叫做类)
4.5 常量名使用PASCAL 规则 或 全大写。
4.6 系统辅助对象使用 $ 开头的骆驼规则。 ( 比如使用了javascrpt关键字或保留字，而不得不更名的对象，或者需要在其它对象创建的成员，又同时要避免这个成员有冲突)
4.7 对 this 的临时保存使用 me 。
4.8 不允许对单词随便缩写，原则上保留单词的全拼。
4.9 首先遵守 Javascript 本身的语言命名规则，然后遵守其它库和语言的命名，最后按照作者的风格命名。



5. 语句


5.1 变量声明: 使用 var 。多个变量不写多个var 。 如下:

var a = 2,
    b = 1;   // b 前面是一个 Tab 或 4 个空格。

5.2 标签:   在不需要的时候不要使用标签。如下的不允许的:

cc:   vv = 2;

5.3 单行 if/while 语句:  不强制一定要为单行语句添加 {}， 您可以根据习惯决定。

5.4 for(var a in b) 语句: 如果这里的变量a只在 for in 内用建议将 var 放到 for in 内。 for(;;)同理。

5.5 continue 和 break 语句: 没有强制要求。

5.6 return 语句: 不建议在 return 后的值加括号。

5.7 while(true) 语句: 建议使用 true，而不是其它变量。 false  同理。

for ( ;true; ) 时， true 应该不写。

5.8 使用{}替代new Object()。使用[]替代new Array()。 

5.9 使用 .toString ，而不是 + ""

5.10 除了 for () 内，  不要使用逗号语句。

5.11 不要使用多余的 {} 块。

5.12 不要使用 with 语句。

5.13 判断语句可以为赋值语句，但不建议。

5.14 ===和!==操作符: 不作限制，但使用 === 和 !== 更好。

5.15 函数声明语句、变量定义语句 不应该放在 逻辑块内。 比如下面的例子是不对的:

if (x) {
  function foo() {}
}


5.16 为每个语句增加; 。

5.17 立即执行函数加括号，如:

(function(){

})();

5.18 闭包: 没有限制。当然如果出现10层上的闭包，您应该检查代码质量。

5.19 异常: 任何对象都可以作为异常抛出。建议抛出 Error 及继承对象 或 字符串。

5.20 使用 && 和 || 代替if语句: 没有限制。但建议只在需要的时候，而不应该故意使用这个格式。

5.21 IE CC 语句: 不建议使用。

5.22 {} 和 [] 内多余的 , :  不应该出现。


6 效率

6.1 eval 函数和 Function 函数: 不需要的时候不要使用。

6.2 多行字符串常量: 可以使用下面 2 种格式之一， 使用第1种时注意: 它虽然被目前全部浏览器支持，但这不是标准。


var a = 'aa\

vv'


或


var a = 'aa' +
'vv'


6.3 字符串单引号，双引号: 如果内容是 HTML 字符串，确保 HTML 使用 "， 否则没有强制要求。

6.4 多字符串连接: 建议使用数组 join 拼接。




7.  JPlus 规范


7.1 API函数应该对参数进行 assert 确认。

7.2  尽量为类 定义 xType 属性 和 toString 方法。

7.3  先书写 imports  然后书写 using

7.4  示例使用 trace 输出。