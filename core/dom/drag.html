<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<title>J+ Core 测试</title>
		<script type="text/javascript" src="../../jplus/system.js" ></script>
		<script type="text/javascript" src="../../jplus/system/dom/element.js" ></script>
		<script type="text/javascript" src="../../jplus/system/dom/drag.js" ></script>
		<script type="text/javascript" src="../../assets/scripts/default.js" ></script>
	</head>
	<body>
		<div id="drag">
			<div id="d1" class="box blue">最简单的拖动</div>
			<div id="d2" class="box purple">返回原地</div>
			<div id="d3" class="box indigo">拖动事件</div>
			<div id="d4" class="box green"><button>拖动句柄</button></div>
			<div id="d5" class="box purple">多像素拖动</div>
			<div id="d6" class="box indigo">限制位置</div>
			<div id="d7" class="box blue">自动刷屏</div>
		</div>
		<script>
			
			$('d1').setDraggable(true);

			$('d3').setDraggable(true).on('dragstart', function(e){
				trace.log("开始   ", e);
			}).on('drag', function(e){
			   	trace.log("拖动   ", e);
			}).on('dragend', function(e){
				trace.log("结束   ", e);
			});
			
			$('d2').setDraggable(true).on('dragend', Function.returnFalse);
			
			$('d4').setDraggable($('d4').find('button'));
			
			$('d5').setDraggable(true).on('drag', function(e){
				
				var STHREH = 60;
				
				var d = Py.DragDrop.Manager;
				
				var value = parseInt(d.delta.x / STHREH);
				
				if(value != d.value){
					
					d.value = value;
				}
				
				e.data.to.x = e.data.from.x + value * STHREH;
				e.data.to.y = e.data.from.y;
			});
			
			$('d6').setDraggable(true).on('drag', function(e){
				
				
				e.data.limit($('zone1').getBound()) ;
			});
			
			$('d7').setDraggable(true).on('drag', function(e){
				var d = e.target;
				
				var scroll = document.getScroll(), win = document.getSize();
				
				scroll.y = e.data.calcBound().bottom - win.y;
				
				if(scroll.y > 0){
					document.setScroll(scroll);
				}

			});
			
		</script>
	</body>
</html>
